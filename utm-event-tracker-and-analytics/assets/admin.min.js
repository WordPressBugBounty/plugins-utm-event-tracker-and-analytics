!function(a){a("#utm-overview-container").on("click"," .cache-notice .button-dismiss-notice",function(t){t.preventDefault(),a("#utm-overview-container .cache-notice").hide();t=new FormData;t.append("_wpnonce",a(this).data("nonce")),t.append("action","utm_event_tracker/dismiss_cache_notice"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t})});const s=wp.hooks.applyFilters("utm_event_tracker_has_pro",!1),t={Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]};var e={template:"#utm-event-tracker-google-analytics-events",components:{"event-settings-modal":{template:"#utm-event-tracker-google-analytics-event-settings",props:{eventNo:{type:Number,required:!0}},data(){var t=JSON.parse(JSON.stringify(this.$root.google_analytics_events[this.eventNo]));return{...utm_event_tracker.event_item_params,...t}},mounted(){const e=this;a(document).keydown(function(t){"Escape"===t.key&&e.close_settings()}),a(document).on("click",".utm-event-tracker-modal",function(t){0===a(t.target).closest(".utm-modal-container").length&&e.close_settings()})},computed:{current_plugin_event(){return this.$root.get_plugin_event(this.event_name)},current_event_type(){return this.current_plugin_event?.event_type},current_condition_template(){return this.current_plugin_event?.condition_template},get_current_conditions(){return this.conditions.filter(t=>t?.condition_template==this.current_condition_template)},get_condition_type_default_value(){return this.current_plugin_event?.condition_type_default_value||""}},methods:{has_ability(t){return!Array.isArray(this.current_plugin_event?.settings_disability)||!this.current_plugin_event.settings_disability.includes(t)},close_settings(t=!1){t&&this.$parent.close_settings(this.$data),this.$parent.close_settings()},add_condition(t){this.conditions.splice(t+1,0,{value:"",type:this.get_condition_type_default_value,condition_template:this.current_condition_template})},remove_condition(t){confirm(utm_event_tracker.i10n.confirm_delete_ga4_condition)&&this.conditions.splice(t,1)},add_custom_param(t){this.custom_params.splice(t+1,0,{key:"",value:""})},remove_custom_param(t){confirm(utm_event_tracker.i10n.confirm_delete_ga4_custom_param)&&this.custom_params.splice(t,1)}}}},props:{events:{default:[]}},data(){return{item_no:null}},computed:{is_free(){return!1===s},custom_events(){return this.$root.custom_events}},methods:{open_settings(t){this.has_settings_ability(t)&&(this.item_no=t)},close_settings(t=!1){"object"==typeof t&&(this.$root.google_analytics_events[this.item_no]={...t}),this.item_no=null},add_event(){if(this.is_free&&1<=this.events.length)return this.$root.show_modal="ga4_locked_modal";this.$root.google_analytics_events.push({...utm_event_tracker.event_item_params,disabled:!1})},delete_event(t){confirm(utm_event_tracker.i10n.confirm_delete_ga4_event)&&this.$root.google_analytics_events.splice(t,1)},has_settings_ability(t){t=this.events[t]?.event_name,t=this.$root.get_plugin_event(t);return void 0!==t&&!0!==t?.disable_settings}}};const n={show_modal:null,session_clearing:!1,preview_mode_updating:!1,...utm_event_tracker.settings_helper_models};var e={components:{"google-analytics-events":e,...wp.hooks.applyFilters("utm_event_tracker_settings_components",{})},data(){return{...n,...utm_event_tracker.setting_models}},computed:{is_free(){return!1===s},get_settings_data(){var t=JSON.parse(JSON.stringify(this.$data));for(const e in n)delete t[e];return JSON.stringify(t)},get_plugins_events(){const e={...utm_event_tracker.google_analytics_plugins_events};return this.custom_events.forEach(t=>{e["custom_event_"+t.event_type]={...t,event_group:"custom_event",settings_disability:["conditions"]}}),e},get_pro_link(){let t="settings";var e={ga4_locked_modal:"add+ga4+event",custom_event_modal:"add+custom+event",append_utm_parameter:"append+utm+parameter",custom_parameters_modal:"add+custom+parameter",create_session_without_utm:"session+without+parameter"};return"https://codiepress.com/plugins/utm-event-tracker-and-analytics-pro/?utm_campaign=utm+event+tracker&utm_source=settings&utm_medium="+(t=e[this.show_modal]?e[this.show_modal]:t)}},mounted(){const e=this;a(document).keydown(function(t){"Escape"===t.key&&e.close_modal()}),a(document).on("click",".utm-event-tracker-modal",function(t){0===a(t.target).closest(".utm-modal-container").length&&e.close_modal()})},methods:{...wp.hooks.applyFilters("utm_event_tracker_settings.methods",{}),clear_session(){const t=this;this.session_clearing=!0;var e=new FormData;e.append("nonce",a(this.$refs.clear_session).data("nonce")),e.append("action","utm_event_tracker/clear_current_session"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:e}).then(t=>t.json()).then(()=>{t.session_clearing=!1})},handle_preview_mode(e){this.preview_mode_updating=!0;var t=new FormData;t.append("preview_mode",e),t.append("nonce",a(this.$refs.preview_mode_nonce).data("nonce")),t.append("action","utm_event_tracker/handle_preview_mode"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{!(this.preview_mode_updating=!1)===t?.success&&(this.disable_preview_mode=e)})},get_plugin_event(t){return this.get_plugins_events[t]},close_modal(){this.show_modal=null},add_custom_event(){if(!s&&1<=this.custom_events.length)return this.show_modal="custom_event_modal";this.custom_events.push({title:"",selector:"",event_type:""})},duplicate_custom_event(t){if(!s&&2<=this.custom_events.length)return this.show_modal="custom_event_modal";this.custom_events.splice(t,0,{...this.custom_events[t]})},delete_custom_event(t){confirm(utm_event_tracker.i10n.confirm_delete_custom_event)&&this.custom_events.splice(t,1)}}},e=(a("#utm-event-tracker-settings").length&&Vue.createApp(e).mount("#utm-event-tracker-settings"),{template:"#utm-event-tracker-pagination",props:{totalItems:{type:Number,default:0},currentPage:{type:Number,default:1},perPage:{type:Number,default:20}},data(){return{item_per_page:this.perPage}},watch:{item_per_page(){this.$emit("changePage",parseInt(this.item_per_page),"per_page")}},computed:{get_total_pages(){return Math.ceil(this.totalItems/this.perPage)},get_pages(){const e=parseInt(this.get_total_pages);var t=parseInt(this.currentPage);let s=[1,2,e-1,e-2,e,t];return s.push(t-2),s.push(t-1),s.push(t+1),s.push(t+2),s=s.filter(t=>0<t&&t<=e),(s=[...new Set(s)].sort()).sort((t,e)=>t-e),s},has_last_page(){return this.currentPage<this.get_total_pages},get_last_page_number(){return this.get_total_pages}},methods:{go_page(t){t<1||t>this.get_last_page_number||this.$emit("changePage",t)}}}),r={template:"#utm-event-tracker-keyword-stats",props:{param:"",type:{default:"session"},dates:{default:[moment().subtract(15,"days"),moment()]},showReportDate:{default:!1}},data(){return{error:null,keywords:[],loading:!0}},computed:{get_date(){return this.dates[0].format("MMM DD, YYYY")+" - "+this.dates[1].format("MMM DD, YYYY")},get_keywords_stats(){return!0===s?this.keywords:this.keywords.slice(0,2)},hided_keywords_count(){var t=this.keywords.length-this.get_keywords_stats.length;return 0<=t?t:0}},mounted(){this.load_data()},watch:{dates(){this.load_data()}},methods:{get_color(t){let e=["#6ad49b","#f35d82","#9c27b0","#8757ed","#5ba6ff"];return(e=!0!==s?["#6ad49b","#f35d82","transparent","transparent","transparent"]:e)[t]},load_data(){this.error=null,this.loading=!0;var t=new FormData;t.append("stats_type",this.type),t.append("parameter",this.param),t.append("end_date",this.dates[1]||""),t.append("start_date",this.dates[0]||""),t.append("_wpnonce",this.$refs.nonce.value),t.append("action","utm_event_tracker/get_keywords_stats"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{!(this.loading=!1)===t.success?this.keywords=t.data:(this.keywords=[],this.error=t.data.error)}).catch(t=>{})}}},o={extends:r,template:"#utm-event-tracker-events-stats",props:{dates:{default:[moment().subtract(15,"days"),moment()]},showReportDate:{default:!1}},methods:{load_data(){this.error=null,this.loading=!0;var t=new FormData;t.append("end_date",this.dates[1]||""),t.append("start_date",this.dates[0]||""),t.append("_wpnonce",this.$refs.nonce.value),t.append("action","utm_event_tracker/get_events_stats"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{!(this.loading=!1)===t.success?this.keywords=t.data:(this.keywords=[],this.error=t.data.error)}).catch(t=>{})}}},i={template:"#session-summary",props:["session"],methods:{close_summary(){this.$emit("close")}},computed:{lock_event_count(){return!0===s?0:parseInt(this.session.total_events)-this.session.events.length}}},d={template:"#utm-event-tracker-overview-widget",props:{param:{type:String,required:!0}},data(){return{data:[],loading:!0,type:"keywords",sort_desc:"asc",order_by:"sessions",dates:[moment().subtract(6,"days"),moment()]}},mounted(){const s=this;a(this.$refs.datepicker).daterangepicker({startDate:s.dates[0],endDate:s.dates[1],locale:{format:"MMM DD, YYYY"},ranges:t},function(t,e){s.dates=[t,e]}),this.fetch_data()},watch:{dates(){this.fetch_data()},type(){this.fetch_data()}},computed:{get_report(){return this.sort_desc?"date"===this.order_by?this.data.sort((t,e)=>e[this.order_by]>t[this.order_by]?1:-1):this.data.sort((t,e)=>e[this.order_by]-t[this.order_by]):"date"===this.order_by?this.data.sort((t,e)=>t[this.order_by]-e[this.order_by]?1:-1):this.data.sort((t,e)=>t[this.order_by]-e[this.order_by])},is_empty(){return 0==this.data.length}},methods:{get_date_text(){return this.dates[0].format("MMM DD, YYYY")+" - "+this.dates[1].format("MMM DD, YYYY")},fetch_data(){this.loading=!0;var t=new FormData;t.append("action","utm_event_tracker/get_keywords_report"),"date"===this.type&&t.append("action","utm_event_tracker/get_date_report"),t.append("param",this.param),t.append("_wpnonce",this.$refs.nonce.value),t.append("start_date",this.dates[0].format()),t.append("end_date",this.dates[1].format()),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{this.loading=!1,this.data=Array.isArray(t.data)?t.data:[]}).catch(t=>{this.data=[]})},sort_report(t){t===this.order_by&&(this.sort_desc=!this.sort_desc),this.order_by=t},get_sort_column_class(t){return this.order_by!==t?"":this.sort_desc?"sort-desc":"sort-asc"}}},d={components:{"overview-widget":d,"overview-widget-event":{extends:d,template:"#utm-event-tracker-widget-event",data(){return{type:"events",order_by:"events"}},methods:{fetch_data(){this.loading=!0;var t=new FormData;t.append("action","utm_event_tracker/get_event_overview_query"),"date"===this.type&&t.append("action","utm_event_tracker/get_event_date_overview_data"),t.append("_nonce",this.$refs.nonce.value),t.append("start_date",this.dates[0].format()),t.append("end_date",this.dates[1].format()),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{this.loading=!1,this.data=Array.isArray(t.data)?t.data:[]}).catch(t=>{this.data=[]})}}}},data(){return{first_load:!0,hide_widgets:[],show_overview_setting:!1}},created(){var t=document.getElementById("utm-overview-container");try{var e=JSON.parse(t.getAttribute("data-settings"));"object"==typeof e&&(void 0!==e.hide_widgets&&Array.isArray(e.hide_widgets)||(e.hide_widgets=[]),this.hide_widgets=e.hide_widgets)}catch(t){}},mounted(){const e=this;this.first_load=!1,a(document).keyup(function(t){"Escape"===t.key&&a("#overview-settings").length&&(e.show_overview_setting=!1)}),a("#overview-settings").on("click",function(t){a(t.target).closest("#overview-settings .popup-content").length||(e.show_overview_setting=!1)})},methods:{widget_is_visible(t){return this.hide_widgets.includes(t)},update_widget_visibility(t){var e=this.hide_widgets,s=e.indexOf(t);-1<s?e.splice(s,1):e.push(t),this.hide_widgets=e},get_visibility_class(t){return this.hide_widgets.includes(t)?"utm-event-tracker-icon-eye-slash":"utm-event-tracker-icon-eye"},save_settings(){if(!this.first_load){const e=new FormData;e.append("_wpnonce",this.$refs.nonce.value),e.append("action","utm_event_tracker/update_overview_settings"),this.hide_widgets.forEach(t=>{e.append("hide_widgets[]",t)}),fetch(utm_event_tracker.ajax_url,{method:"POST",body:e})}}},watch:{hide_widgets:{handler(){this.save_settings()},deep:!0}}},d=(a("#utm-overview-container").length&&Vue.createApp(d).mount("#utm-overview-container"),{template:"#utm-event-tracker-session-list-param",props:{column:{type:String,default:"utm_campaign"},dates:{default:[moment().subtract(15,"days"),moment()]},keywords:{default:""}},data(){return{page:1,data:[],timer:null,per_page:20,loading:!0,total_items:0,sort_type:"DESC",view_session:null,sort_column:"created_on",session_type:"individual"}},components:{"utm-event-tracker-pagination":e,"session-summary":i},mounted(){const e=this;this.load_data(),a(document).keyup(function(t){"Escape"===t.key&&a("#session-details-container").length&&(e.view_session=null)}),a(document).on("click",function(t){a(t.target).closest("#session-details-container").length||null!==e.view_session&&(e.view_session=null)})},watch:{dates(){this.load_data()},keywords(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.page=1,this.load_data()},500)}},computed:{get_data(){return this.data},is_empty(){return 0===this.data.length},get_total_session_events(){return this.view_session.total_events}},methods:{set_session(e){this.view_session=this.data.filter(t=>t.id==e)[0]},get_date_label(){return this.dates[0].format("MMM DD, YYYY")+" - "+this.dates[1].format("MMM DD, YYYY")},sort_report(t){t===this.sort_column&&("DESC"===this.sort_type?this.sort_type="ASC":this.sort_type="DESC"),this.sort_column=t,this.load_data()},get_sort_column_class(t){return this.sort_column!==t?"":"DESC"===this.sort_type?"sort-desc":"sort-asc"},load_data(){this.loading=!0;var t=new FormData;t.append("page",this.page),t.append("column",this.column),t.append("per_page",this.per_page),t.append("keywords",this.keywords),t.append("sort_type",this.sort_type),t.append("sort_column",this.sort_column),t.append("session_type",this.session_type),t.append("end_date",this.dates[1].format()),t.append("_wpnonce",this.$refs.nonce.value),t.append("start_date",this.dates[0].format()),t.append("action","utm_event_tracker/get_sessions"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{this.loading=!1,this.total_items=parseInt(t.data.total),this.data=Array.isArray(t.data.items)?t.data.items:[]}).catch(()=>{this.loading=!1})},updatePagination(t,e="page"){"page"===e&&(this.page=t),"per_page"===e&&(this.page=1,this.per_page=t),this.load_data()},close_summary(){this.view_session=null}}});const _={components:{"session-list-all":{extends:d,template:"#utm-event-tracker-session-list-all",data(){return{session_type:"all"}}},"session-list-param":d,"keyword-stats":r,"events-stats":o,"session-list-events":{extends:d,template:"#utm-event-tracker-session-list-events",props:{column:{type:String,default:"events"}},methods:{load_data(){this.loading=!0;var t=new FormData;t.append("page",this.page),t.append("per_page",this.per_page),t.append("keywords",this.keywords),t.append("sort_type",this.sort_type),t.append("sort_column",this.sort_column),t.append("end_date",this.dates[1].format()),t.append("_wpnonce",this.$refs.nonce.value),t.append("start_date",this.dates[0].format()),t.append("action","utm_event_tracker/get_events_list"),fetch(utm_event_tracker.ajax_url,{method:"POST",body:t}).then(t=>t.json()).then(t=>{this.loading=!1,this.total_items=parseInt(t.data.total),this.data=Array.isArray(t.data.items)?t.data.items:[]}).catch(t=>{this.loading=!1})}}}},data(){return{timer:null,keywords:"",dates:[moment().subtract(14,"days"),moment()]}},mounted(){const s=this;a(this.$refs.datepicker).daterangepicker({startDate:s.dates[0],endDate:s.dates[1],locale:{format:"MMM DD, YYYY"},ranges:t},function(t,e){s.dates=[t,e]})},methods:{reload(){this.$refs.keyword_list_table.load_data()}}};["session-list-report","utm-campaigns-analysis-dashboard","utm-medium-analysis-dashboard","utm-source-analysis-dashboard","utm-content-analysis-dashboard","utm-term-analysis-dashboard","events-analysis-dashboard"].forEach(t=>{a("#"+t).length&&Vue.createApp(_).mount("#"+t)})}(jQuery);